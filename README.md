# Gmail OTP Extension

Минимальное расширение Chrome для поиска OTP-кодов в Gmail. Постепенно учится на ваших отметках.

## Установка (локально)

1. Откройте `chrome://extensions`.
2. Включите режим разработчика.
3. Нажмите **Load unpacked**.
4. Выберите папку `gmail-otp-extension`.

## Настройка

1. Нажмите **Подключить** и выберите Gmail-аккаунт.
2. При необходимости измените фильтр писем.
3. Включите **Только непрочитанные**, если нужно.
4. В разделе **Фильтры → Продвинутые настройки → Security**:
   - задайте `Allowed sites for OTP paste` (домен на строку) при необходимости,
   - задайте `Clipboard auto-clear (seconds)` (0 = не очищать).

## Как это работает

- Расширение проверяет Gmail раз в минуту и показывает уведомление, если найден код.
- В popup можно вручную найти и скопировать последний код.
- Неопознанные письма можно помечать как “код” или “не код” — это улучшает распознавание со временем.
- Вставка кода в страницу разрешена только на `https://`.
- Если allowlist сайтов заполнен, вставка работает только для доменов из allowlist.

## Безопасность

- OTP не логируется в консоль страницы.
- Есть защита экспорта от CSV formula injection (`=`, `+`, `-`, `@`).
- Есть опциональная автоочистка буфера обмена после копирования.

## Почему код не вставляется

Проверьте по порядку:

1. Сайт открыт по `https://` (не `http://`).
2. Активный домен разрешён в `Allowed sites for OTP paste` (если список не пустой).
3. На странице есть видимое поле для OTP (по атрибутам `otp/code/pin/2fa` или `autocomplete=one-time-code`).
